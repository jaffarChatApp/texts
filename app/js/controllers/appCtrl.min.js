ChatApp.controller("appCtrl",["$scope","$rootScope","$http","$state","$sessionStorage","$filter","$mdToast","$mdMenu","$timeout","$mdSidenav","CONFIG",function(e,t,s,o,n,a,r,i,l,c,g){e.selected="dashboard",e.showLoginArea=!0,e.toggleList=function(){c("left").toggle()},e.openMenu=function(e){i.open(e)},e.register={name:"",email:"",mobile:"",password:"",profession:"",registeredDate:new Date},e.lodinData={password:"",email:"",loginDate:new Date},e.getUsers=function(){s({method:"GET",url:g.rootUrl+"getUsers",headers:{"Content-Type":"application/json"}}).then(function(e){})},e.getUsers(),e.submitForm=function(){var t=Math.random().toString(36).slice(2).substring(0,6),o={Name:e.register.name,Email:e.register.email,Password:e.register.password,Mobile:e.register.mobile,Profession:e.register.profession,Registered_Date:e.register.registeredDate.getTime(),UserId:t};s({method:"POST",url:g.nodeJsUrl+"registerUser",headers:{"Content-Type":"application/json"},data:o}).then(function(t){e.loading=!1,1==t.data.success&&(e.msgContent="Registered successfully.",e.toasterClass="successClass",e.showAlertMessage(),l(function(){e.checkUserExist("login")},500))})},e.createTable=function(){s({method:"GET",url:g.nodeJsUrl+"createTable",headers:{"Content-Type":"application/json"}}).then(function(t){e.loading=!1})},e.login=function(){""!=e.register.email&&""!=e.register.password?e.checkUserExist("login"):(""==e.register.email&&""==e.register.password?e.msgContent="Please enter email Id and Password.":(""==e.register.email&&(e.msgContent="Please enter email Id."),""==e.register.password&&(e.msgContent="Please enter Password.")),e.toasterClass="warningClass",e.showAlertMessage())},e.checkUserExist=function(t){e.loading=!0;var a={email:e.register.email,password:e.register.password};s({method:"POST",url:g.nodeJsUrl+"checkUserExist",headers:{"Content-Type":"application/json"},data:a}).then(function(s){e.loading=!1,1==s.data.success?(n.userData=s.data.userData,"login"==t?(o.go("home.dashboard"),e.msgContent="Login successfully.",e.toasterClass="successClass"):(e.msgContent="Your email id is registered with us, please login to continue.",e.toasterClass="warningClass"),e.showAlertMessage()):(e.msgContent=s.data.msg,e.toasterClass="errorClass",e.showAlertMessage())})},e.showView=function(t){"register"==t?(e.showLoginArea=!1,e.showRegisterArea=!0):(e.showRegisterArea=!1,e.showLoginArea=!0)},e.showAlertMessage=function(){r.show(r.simple().textContent(e.msgContent).position("top left").hideDelay(3e3).toastClass(e.toasterClass))},e.getUserData=function(t){"chat"==t?(e.showMenuIcon=!1,e.showBackIcon=!0):(e.showBackIcon=!1,e.showMenuIcon=!0),e.userData=n.userData},e.logout=function(){o.go("login"),n.$reset()},e.goBack=function(){o.go("home.dashboard")},t.pageTitle=function(){return e.title=o.current.title,e.title},e.getUserList=function(){var t=angular.copy({userId:"jaffar"});JSON.stringify(t);s({method:"GET",url:g.rootUrl+"function=getUsers",headers:{"Content-Type":"application/json"}}).then(function(t){1==t.data.success&&t.data.userData.length>0&&(e.userList=t.data.userData)})},e.createFile=function(e){s({method:"GET",url:g.rootUrl+"function=createFile",headers:{"Content-Type":"application/json"}}).then(function(e){})},e.updateFile=function(e){s({method:"GET",url:g.rootUrl+"function=updateFile",headers:{"Content-Type":"application/json"}}).then(function(e){})},e.appendFile=function(e){s({method:"GET",url:g.rootUrl+"function=appendFile",headers:{"Content-Type":"application/json"}}).then(function(e){})}}]);